CC = 'clang'

CFLAGS = " ".join([
    '-Weverything',
    '-std=c11'
])

ragel = Builder(action = 'ragel -G2 $SOURCE -o $TARGET',
                suffix = '.c',
                src_suffix = '.rl')

env = Environment( CC=CC
                  ,CCFLAGS=CFLAGS
                  ,BUILDERS={'Ragel' : ragel} )

roth = env.Program('roth', 'main.c')

tests = env.Program('tests.c');
check = env.Command(target = 'check',
                    source = 'tests',
                    action = './' + tests[0].path)
env.Depends(check, tests)
